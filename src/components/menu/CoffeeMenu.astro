---
import {MenuItemsSchema} from "@/types"
import MenuItem from "./MenuItem.astro"
const url= `${import.meta.env.API_URL}/products?products_categories=6`
const res = await fetch(url)
const json = await res.json()
const data = MenuItemsSchema.parse(json)
---

<div class="">
    <h4 class="text-white font-black text-4xl uppercase text-center my-10">Caf√©</h4>

    <ul id="coffee-menu" class="space-y-3">
        {
            data.map(item=>(
                <MenuItem
                    title={item.title.rendered}
                    description={item.acf.description}
                    price={item.acf.price} 
                    image={item.feature_images}
                />
            ))
        }
    </ul>
</div>

<script >
    import PhotoSwipeLightbox from "photoswipe/lightbox"
    import "photoswipe/style.css"

    const lighbox = new PhotoSwipeLightbox({
        gallery: "#coffee-menu",
        children: "a",
        pswpModule:()=>import("photoswipe")
    })
    document.addEventListener("astro:after-swap",function(){
        lighbox.init()
    })
    
</script>